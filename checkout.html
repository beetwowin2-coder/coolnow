<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Cool Now</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; }
        .active-push:active { transform: scale(0.98); }
    </style>
</head>
<body class="bg-[#FBFBFD] text-gray-800 pb-20">

    <nav class="p-6">
        <a href="index.html" class="text-gray-400 hover:text-gray-600 flex items-center gap-2 transition">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
        </a>
    </nav>

    <main class="container mx-auto max-w-2xl px-4">
        <h1 class="text-3xl font-bold mb-8">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h1>

        <div id="checkoutItems" class="space-y-4 mb-8">
            </div>

        <section class="bg-white rounded-[2rem] p-8 shadow-sm border border-gray-100 mb-6">
            <h2 class="text-lg font-bold mb-4">üìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</h2>
            <textarea id="address" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö..." 
                      class="w-full h-32 bg-gray-50 rounded-2xl p-4 focus:outline-none border border-transparent focus:border-pink-200 transition-all"></textarea>
        </section>

        <section class="bg-white rounded-[2rem] p-8 shadow-sm border border-gray-100 mb-8">
            <h2 class="text-lg font-bold mb-4">üí∞ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
            <div class="bg-blue-50 border border-blue-100 rounded-2xl p-6 flex items-start gap-4">
                <div class="bg-white p-2 rounded-xl shadow-sm text-2xl">üè¶</div>
                <div>
                    <p class="font-bold text-blue-900">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û (BBL)</p>
                    <p class="text-blue-700 text-sm mt-1">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: <span class="font-bold">‡∏ì‡∏±‡∏ê‡∏ë‡∏¥‡∏ä‡∏≤ ‡∏™‡∏±‡∏à‡∏à‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏∞</span></p>
                    <p class="text-blue-800 font-bold mt-1 tracking-wider">XXX-X-XXXXX-X</p> 
                    <p class="text-[10px] text-blue-400 mt-2">*‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
                </div>
            </div>
            
            <div class="mt-6">
                <p class="text-sm font-bold mb-3">‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
                <input type="file" id="slip" accept="image/*" class="text-xs text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-pink-50 file:text-pink-700 hover:file:bg-pink-100 cursor-pointer w-full">
            </div>
        </section>

        <div class="bg-white rounded-[2rem] p-8 shadow-xl shadow-pink-50/50 border border-pink-50">
            <div class="space-y-3 mb-6" id="summaryArea">
                </div>
            <button onclick="confirmOrder()" class="w-full bg-pink-500 text-white py-5 rounded-2xl font-bold text-lg shadow-lg shadow-pink-100 hover:bg-pink-600 transition active-push flex items-center justify-center gap-2">
                ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ üöÄ
            </button>
            <p class="text-center text-[10px] text-gray-400 mt-4">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ó‡πà‡∏≤‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
        </div>
    </main>

    <script>
        let cart = JSON.parse(localStorage.getItem('coolNowCart')) || [];

        function renderCheckout() {
            const itemsContainer = document.getElementById('checkoutItems');
            const summaryArea = document.getElementById('summaryArea');
            let subtotal = 0;
            let totalItems = 0;

            if (cart.length === 0) {
                window.location.href = 'index.html';
                return;
            }

            itemsContainer.innerHTML = '';
            cart.forEach((item, index) => {
                subtotal += item.price * item.qty;
                totalItems += item.qty;
                itemsContainer.innerHTML += `
                    <div class="bg-white p-4 rounded-[1.8rem] border border-gray-100 flex items-center gap-4 shadow-sm">
                        <img src="${item.img}" class="w-20 h-20 object-contain bg-gray-50 rounded-2xl">
                        <div class="flex-1">
                            <h3 class="font-bold text-sm">${item.name}</h3>
                            <p class="text-pink-500 font-bold">${item.price} ‡∏ø</p>
                        </div>
                        <div class="flex items-center gap-3 bg-gray-50 p-2 rounded-xl">
                            <button onclick="updateQty(${index}, -1)" class="w-8 h-8 bg-white rounded-lg shadow-sm flex items-center justify-center font-bold active-push">-</button>
                            <span class="font-bold w-4 text-center">${item.qty}</span>
                            <button onclick="updateQty(${index}, 1)" class="w-8 h-8 bg-white rounded-lg shadow-sm flex items-center justify-center font-bold active-push">+</button>
                        </div>
                    </div>
                `;
            });

            const shippingFee = (totalItems >= 2) ? 0 : 40;
            const total = subtotal + shippingFee;

            summaryArea.innerHTML = `
                <div class="flex justify-between text-gray-400 font-medium">
                    <span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
                    <span>${subtotal.toLocaleString()} ‡∏ø</span>
                </div>
                <div class="flex justify-between text-gray-400 font-medium">
                    <span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</span>
                    <span class="${shippingFee === 0 ? 'text-green-500 font-bold' : ''}">${shippingFee === 0 ? '‡∏ü‡∏£‡∏µ' : '40 ‡∏ø'}</span>
                </div>
                <div class="flex justify-between items-end pt-4 border-t mt-2">
                    <span class="text-xl font-bold">‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span>
                    <span class="text-3xl font-bold text-pink-500">${total.toLocaleString()} ‡∏ø</span>
                </div>
            `;
        }

        function updateQty(index, amt) {
            cart[index].qty += amt;
            if (cart[index].qty <= 0) {
                if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    cart.splice(index, 1);
                } else {
                    cart[index].qty = 1;
                }
            }
            localStorage.setItem('coolNowCart', JSON.stringify(cart));
            renderCheckout();
        }

        function confirmOrder() {
            const address = document.getElementById('address').value;
            const slip = document.getElementById('slip').files[0];

            if (!address.trim()) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á');
            if (!slip) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô');

            // ‡∏™‡πà‡∏ß‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Firebase ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            alert('‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ Cool Now');
            localStorage.removeItem('coolNowCart');
            window.location.href = 'order-success.html';
        }

        window.onload = renderCheckout;
    </script>
</body>
</html>
