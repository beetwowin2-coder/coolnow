<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Cool Now</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; }
        .active-push:active { transform: scale(0.98); }
        #uploadZone.drag-over { border-color: #ec4899; background-color: #fdf2f8; }
    </style>
</head>
<body class="bg-[#FBFBFD] text-gray-800 pb-20">

    <nav class="p-6">
        <a href="index.html" class="text-gray-400 hover:text-gray-600 flex items-center gap-2 transition">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
        </a>
    </nav>

    <main class="container mx-auto max-w-2xl px-4">
        <h1 class="text-3xl font-bold mb-8 text-center md:text-left">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h1>

        <div id="checkoutItems" class="space-y-4 mb-8">
            </div>

        <section class="bg-white rounded-[2rem] p-8 shadow-sm border border-gray-100 mb-6">
            <h2 class="text-lg font-bold mb-4 flex items-center gap-2">üìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</h2>
            <textarea id="address" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå ‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö..." 
                      class="w-full h-32 bg-gray-50 rounded-2xl p-4 focus:outline-none border border-transparent focus:border-pink-200 transition-all"></textarea>
        </section>

        <section class="bg-white rounded-[2.5rem] p-8 shadow-sm border border-gray-100 mb-8">
            <h2 class="text-lg font-bold mb-6">üí∞ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
            
            <div class="bg-blue-50 border border-blue-100 rounded-[2rem] p-6 flex items-start gap-4 mb-8">
                <div class="bg-white p-3 rounded-2xl shadow-sm">
                    <img src="https://www.bbl.co.th/images/logo.png" class="w-8 h-8 object-contain" alt="‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û">
                </div>
                <div>
                    <p class="text-[10px] font-bold text-blue-400 uppercase tracking-widest">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û (BBL)</p>
                    <p class="text-blue-900 font-bold text-lg">‡∏ì‡∏±‡∏ê‡∏ë‡∏¥‡∏ä‡∏≤ ‡∏™‡∏±‡∏à‡∏à‡∏∞‡∏ß‡∏±‡∏í‡∏ô‡∏∞</p>
                    <p class="text-blue-700 font-bold text-xl tracking-tighter mt-1">930-0-272847</p>
                </div>
            </div>
            
            <div class="space-y-4">
                <p class="text-sm font-bold text-gray-700 ml-1">‡πÅ‡∏ô‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
                
                <div id="uploadZone" 
                     onclick="document.getElementById('slipInput').click()"
                     class="relative group cursor-pointer border-2 border-dashed border-pink-200 bg-pink-50/30 rounded-[2rem] p-8 transition-all hover:border-pink-400 hover:bg-pink-50 flex flex-col items-center justify-center min-h-[220px]">
                    
                    <input type="file" id="slipInput" accept="image/*" class="hidden" onchange="previewSlip(this)">
                    
                    <div id="uploadPrompt" class="text-center">
                        <div class="w-16 h-16 bg-white rounded-2xl shadow-sm flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform text-3xl">
                            üì∏
                        </div>
                        <p class="font-bold text-pink-600 uppercase tracking-tight">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ</p>
                        <p class="text-xs text-pink-400 mt-1">‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                    </div>

                    <div id="previewContainer" class="hidden w-full flex flex-col items-center">
                        <img id="slipPreview" src="#" class="max-h-64 rounded-xl shadow-md border-2 border-white mb-3">
                        <button type="button" class="text-xs font-bold text-pink-500 hover:underline">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</button>
                    </div>
                </div>
            </div>
        </section>

        <div class="bg-white rounded-[2.5rem] p-8 shadow-xl shadow-pink-100/30 border border-pink-50">
            <div class="space-y-3 mb-6" id="summaryArea">
                </div>
            <button onclick="confirmOrder()" class="w-full bg-pink-500 text-white py-5 rounded-2xl font-bold text-lg shadow-lg shadow-pink-200 hover:bg-pink-600 transition active-push flex items-center justify-center gap-2">
                ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ üöÄ
            </button>
            <p class="text-center text-[10px] text-gray-400 mt-4 tracking-tight">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ó‡πà‡∏≤‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
        </div>
    </main>

    <script>
        let cart = JSON.parse(localStorage.getItem('coolNowCart')) || [];

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ß‡∏≤‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤
        function renderCheckout() {
            const itemsContainer = document.getElementById('checkoutItems');
            const summaryArea = document.getElementById('summaryArea');
            let subtotal = 0;
            let totalItems = 0;

            if (cart.length === 0) {
                window.location.href = 'index.html';
                return;
            }

            itemsContainer.innerHTML = '';
            cart.forEach((item, index) => {
                subtotal += item.price * item.qty;
                totalItems += item.qty;
                itemsContainer.innerHTML += `
                    <div class="bg-white p-4 rounded-[1.8rem] border border-gray-100 flex items-center gap-4 shadow-sm">
                        <img src="${item.img}" class="w-16 h-16 md:w-20 md:h-20 object-contain bg-gray-50 rounded-2xl">
                        <div class="flex-1">
                            <h3 class="font-bold text-sm md:text-base leading-tight text-gray-800">${item.name}</h3>
                            <p class="text-pink-500 font-bold mt-1">${item.price} ‡∏ø</p>
                        </div>
                        <div class="flex items-center gap-3 bg-gray-50 p-2 rounded-xl border border-gray-100">
                            <button onclick="updateQty(${index}, -1)" class="w-8 h-8 bg-white rounded-lg shadow-sm flex items-center justify-center font-bold active-push">-</button>
                            <span class="font-bold w-4 text-center text-sm">${item.qty}</span>
                            <button onclick="updateQty(${index}, 1)" class="w-8 h-8 bg-white rounded-lg shadow-sm flex items-center justify-center font-bold active-push">+</button>
                        </div>
                    </div>
                `;
            });

            const shippingFee = (totalItems >= 2) ? 0 : 40;
            const total = subtotal + shippingFee;

            summaryArea.innerHTML = `
                <div class="flex justify-between text-gray-400 font-medium">
                    <span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
                    <span>${subtotal.toLocaleString()} ‡∏ø</span>
                </div>
                <div class="flex justify-between text-gray-400 font-medium">
                    <span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</span>
                    <span class="${shippingFee === 0 ? 'text-green-500 font-bold' : ''}">
                        ${shippingFee === 0 ? '‡∏ü‡∏£‡∏µ (‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô)' : '40 ‡∏ø'}
                    </span>
                </div>
                <div class="flex justify-between items-end pt-4 border-t border-dashed mt-2">
                    <span class="text-xl font-bold text-gray-800 uppercase">‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span>
                    <span class="text-3xl font-bold text-pink-500">${total.toLocaleString()} ‡∏ø</span>
                </div>
            `;
        }

        // ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        function updateQty(index, amt) {
            cart[index].qty += amt;
            if (cart[index].qty <= 0) {
                if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    cart.splice(index, 1);
                } else {
                    cart[index].qty = 1;
                }
            }
            localStorage.setItem('coolNowCart', JSON.stringify(cart));
            renderCheckout();
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ
        function previewSlip(input) {
            const prompt = document.getElementById('uploadPrompt');
            const container = document.getElementById('previewContainer');
            const preview = document.getElementById('slipPreview');
            const zone = document.getElementById('uploadZone');

            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    prompt.classList.add('hidden');
                    container.classList.remove('hidden');
                    zone.classList.remove('border-dashed');
                    zone.classList.add('border-solid', 'border-pink-500', 'bg-white');
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á (Drag & Drop)
        const zone = document.getElementById('uploadZone');
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(evt => {
            zone.addEventListener(evt, (e) => { e.preventDefault(); e.stopPropagation(); });
        });
        zone.addEventListener('dragover', () => zone.classList.add('drag-over'));
        zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
        zone.addEventListener('drop', (e) => {
            zone.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if(files.length) {
                document.getElementById('slipInput').files = files;
                previewSlip(document.getElementById('slipInput'));
            }
        });

        // ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
        function confirmOrder() {
            const address = document.getElementById('address').value;
            const slip = document.getElementById('slipInput').files[0];

            if (!address.trim()) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á');
            if (!slip) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô');

            // ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            alert('‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ä‡πâ‡∏≠‡∏õ‡∏Å‡∏±‡∏ö Cool Now');
            localStorage.removeItem('coolNowCart');
            window.location.href = 'order-success.html';
        }

        window.onload = renderCheckout;
    </script>
</body>
</html>
